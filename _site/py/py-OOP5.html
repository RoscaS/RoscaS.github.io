<!DOCTYPE html>
<html>

    <head>
        <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- CSS -->

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://localhost:4000/py/py-OOP5.html">
  <link rel="alternate" type="application/rss+xml" title="RoscaS" href="http://localhost:4000/feed.xml">

</head>


        
          <script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    
  ga('create', 'UA-99742998-1', 'auto');
  ga('send', 'pageview');
    
	</script>


        

        
    </head>

    <body>
        <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Py: OOP 5 Héritage multiple, composition, délégation</title>
  <meta name="description" content="sources  sam&amp;max">
</head>


        <div class="wrapper">
            <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<header class="post-header">

    <center>
		<div class="post-title" itemprop="name headline">Py: OOP 5 Héritage multiple, composition, délégation</div>

		<div class="post-meta"><i class="fa fa-calendar-o"></i> <time datetime="29 Jul 2017" itemprop="datePublished">Jul 29 2017</time>

			&nbsp;&nbsp;•&nbsp;&nbsp;<i class="fa fa-user-secret"></i> <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Sol</span>
        	
			<br>
			<i class="fa fa-eye"></i> <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-pulse"></i></span>clicks</span>
		</div>

        	
        <div class="post-tags">
        	
			<a class="post-tags-item" href="http://localhost:4000/tags/">divers,</a>
        	
			<a class="post-tags-item" href="http://localhost:4000/tags/">fr,</a>
        	
			<a class="post-tags-item" href="http://localhost:4000/tags/">en</a>
        	
			
		</div>
    </center>

<div class="wrapper">

    <center>      
		<p>
			<a class="link" href="/">Home</a> /
			<a class="link" href="/archive/">Archive</a> /
			<a class="link" href="/category/">Category</a> / 
			<a class="link" href="/tags/">Tags</a> / 
			<a class="link" href="/about/">About</a> /
			<a class="link" href="/contact/">Contact</a>
    	</p>
    </center>
</div>
    
</header>

<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
<div class="post-content">
    <center>
	
	<p>Programmation orienté objet</p>
	
    </center>
	<h2>Directory</h2>
</div>

<div id="category"></div>

<div class="post-content" itemprop="articleBody">
    <h4 id="sources">sources</h4>
<ul>
  <li><a href="http://sametmax.com/le-guide-ultime-et-definitif-sur-la-programmation-orientee-objet-en-python-a-lusage-des-debutants-qui-sont-rassures-par-les-textes-detailles-qui-prennent-le-temps-de-tout-expliquer-partie-1/">sam&amp;max</a></li>
</ul>

<h1 id="héritage-multiple">Héritage multiple</h1>

<p>Dans un jeux vidéo, nous avons des protections et des armes pour les personnages:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Arme</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nom</span><span class="p">,</span> <span class="n">degat</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nom</span>   <span class="o">=</span> <span class="n">nom</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">degat</span> <span class="o">=</span> <span class="n">degat</span>
    
    <span class="k">def</span> <span class="nf">attaque</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cible</span><span class="p">):</span>
        <span class="n">cible</span><span class="o">.</span><span class="n">vie</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">degat</span>

<span class="k">class</span> <span class="nc">Protection</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nom</span><span class="p">,</span> <span class="n">armure</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nom</span>    <span class="o">=</span> <span class="n">nom</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">armure</span> <span class="o">=</span> <span class="n">armure</span>
    
    <span class="k">def</span> <span class="nf">defend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">degat</span><span class="p">):</span> <span class="c"># mitige dégats</span>
        <span class="n">degat</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">armure</span>
        <span class="k">if</span> <span class="n">degat</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">degat</span>

<span class="n">epee</span>   <span class="o">=</span> <span class="n">Arme</span><span class="p">(</span><span class="s">'Epée de ouf'</span><span class="p">,</span> <span class="n">degat</span> <span class="o">=</span> <span class="mi">999</span><span class="p">)</span>
<span class="n">casque</span> <span class="o">=</span> <span class="n">Protection</span><span class="p">(</span><span class="s">'Casque stylé'</span><span class="p">,</span> <span class="n">armure</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre>
</div>

<p>La concurence est rude et on est à la traine. Il faut implémenter un barbar dans le jeu qui puisse taper avec son bouclier.</p>

<p>Une solution serait de créer une nouvelle classe qui hérite des deux classes en même temps:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">ProtectionOffensive</span><span class="p">(</span><span class="n">Arme</span><span class="p">,</span> <span class="n">Protection</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nom</span><span class="p">,</span> <span class="n">degat</span><span class="p">,</span> <span class="n">armure</span><span class="p">):</span>
        <span class="n">Arme</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nom</span><span class="p">,</span> <span class="n">degat</span><span class="p">)</span>        <span class="c"># appel __init__ Arme</span>
        <span class="n">Protection</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nom</span><span class="p">,</span> <span class="n">armure</span><span class="p">)</span> <span class="c"># appel __init__ Protection</span>
</code></pre>
</div>

<p>Comme on a appelé les deux <code class="highlighter-rouge">__init__</code>, on va avoir les attributs settés dans les deux <code class="highlighter-rouge">__init__</code> attachés à cette classe.</p>

<p>Nous avons donc une classe qui possède les méthodes des deux classes parentes:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span><span class="n">bouclier</span> <span class="o">=</span> <span class="n">ProtectionOffensive</span><span class="p">(</span><span class="s">'Bouclier en taule'</span><span class="p">,</span> <span class="n">degat</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">armure</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="k">print</span><span class="p">(</span><span class="s">"degats bouclier:"</span><span class="p">,</span><span class="n">bouclier</span><span class="o">.</span><span class="n">degat</span><span class="p">)</span>
<span class="n">degats</span> <span class="n">bouclier</span><span class="p">:</span> <span class="mi">10</span>
<span class="o">&gt;&gt;&gt;</span><span class="k">print</span><span class="p">(</span><span class="s">"armure bouclier:"</span><span class="p">,</span><span class="n">bouclier</span><span class="o">.</span><span class="n">armure</span><span class="p">)</span>
<span class="n">armure</span> <span class="n">bouclier</span><span class="p">:</span> <span class="mi">100</span>
<span class="o">&gt;&gt;&gt;</span><span class="k">print</span><span class="p">(</span><span class="s">"bouclier.defend(214), degats restants:"</span><span class="p">,</span><span class="n">bouclier</span><span class="o">.</span><span class="n">defend</span><span class="p">(</span><span class="mi">214</span><span class="p">))</span>
<span class="n">bouclier</span><span class="o">.</span><span class="n">defend</span><span class="p">(</span><span class="mi">214</span><span class="p">),</span> <span class="n">degats</span> <span class="n">restants</span><span class="p">:</span> <span class="mi">114</span>
</code></pre>
</div>

<p>Les deux classes parentes ont une méthode <code class="highlighter-rouge">__init__</code> mais <strong>Python ne peut en “copier” qu’une seule</strong> dans l’enfant. Il copie donc la première qu’il trouve. Il va prendre la liste des parents (ici: Arme, Protection) et la lire de gauche à droite. Il va regarder chaque parent, et si la méthode existe, il va la “copier” dans l’enfant. Si il retrouve une méthode de même nom dans un des parents suivant, il l’ignore.</p>

<p>Dans notre exemple, si on fait:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">ProtectionOffensive</span><span class="p">(</span><span class="n">Arme</span><span class="p">,</span> <span class="n">Protection</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre>
</div>

<p><code class="highlighter-rouge">ProtectionOffensive</code> n’aura que la méthode <code class="highlighter-rouge">__init__</code> de <code class="highlighter-rouge">Arme</code>. Or ce n’est pas ce qu’on veut. On va donc override la méthode <code class="highlighter-rouge">__init__</code>, et dedans appeler la méthode <code class="highlighter-rouge">__init__</code> de <code class="highlighter-rouge">Arme</code> <strong>et</strong> celle de <code class="highlighter-rouge">Protection</code>.</p>

<p>Cette syntaxe: <code class="highlighter-rouge">Classe.methode(self, args...)</code> que l’on retrouve dans <code class="highlighter-rouge">Arme.__init__(self, nom, degat)</code> est juste un moyen d’appeler spécifiquement la méthode du parent.</p>

<p>Dans la partie précédente nous avons vu qu’on pouvait faire cela avec <code class="highlighter-rouge">super()</code>. Mais <code class="highlighter-rouge">super()</code> nous retournera la première méthode du premier parent qu’elle trouve: c’est le but de <code class="highlighter-rouge">super()</code>, de faire ça automatiquement sans se soucier de savoir qui est le premier parent à avoir une méthode du bon nom.</p>

<p>C’est utile car parfois c’est le parent du parent du parent qui a la méthode qu’on veut appeler, on ne connaît pas forcément son nom, ou alors on ne veut pas l’hard coder. Dans notre cas, on veut spécifiquement une méthode d’un parent en particulier, il faut donc l’écrire à la main.</p>

<p>De façon générale:</p>

<ul>
  <li>On utilise <code class="highlighter-rouge">super()</code> quand on fait de l’héritage simple où qu’on veut juste appeler la méthode du premier parent venu sans se soucier de son nom (car il peut être très haut dans la chaîne d’héritage).</li>
  <li>On utilise `Classe.methode(self, args…) quand on veut spécifiquement appeler la méthode d’un parent en particulier.</li>
</ul>

<p><span style="color:red"> <strong>ATTENTION</strong> </span></p>

<p>Le <code class="highlighter-rouge">self</code> n’est pas au même endroit dans <code class="highlighter-rouge">super(ClasseCourante, self).methode(args...)</code> et <code class="highlighter-rouge">ClasseParente.methode(self, args...)</code>. Dans le premier cas, on passe la classe courante (que <code class="highlighter-rouge">super()</code> va analyser pour trouver les parents automatiquement) et dans le second, on hard code le nom de la classe parente.</p>

</div>

<div>
	
	<div class="tbc"></div>
	
</div>

<!--<div class="share">
    <p>Share this post with: </p>
	<a href="https://twitter.com/intent/tweet?text=Py: OOP 5 Héritage multiple, composition, délégation@&amp;url=http://localhost:4000/py/py-OOP5.html" class="twitter-share">
		<span class="fa-stack fa-lg">
			<i class="fa fa-circle fa-stack-2x"></i>
			<i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
		</span>
	</a>
    
	<a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/py/py-OOP5.html" class="facebook-share">
		<span class="fa-stack fa-lg">
			<i class="fa fa-circle fa-stack-2x"></i>
			<i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
		</span>
	</a>
    
	<a href="https://plus.google.com/share?url=http://localhost:4000/py/py-OOP5.html" class="googleplus-share">
		<span class="fa-stack fa-lg">
			<i class="fa fa-circle fa-stack-2x"></i>
			<i class="fa fa-google-plus fa-stack-1x fa-inverse"></i>
		</span>
	</a>
</div>
-->

<div id="disqus_thread"></div>


 
</div>


</article>

        </div>

    </body>

<footer class="site-footer">
    <div class="wrapper">
        <center>
            <p>
                <a class="link" href="/%20/">Home</a> /
                <a class="link" href="/archive/">Archive</a> /
                <a class="link" href="/category/">Category</a> /
                <a class="link" href="/tags/">Tags</a> /
                <a class="link" href="/about/">About</a> /
                <a class="link" href="/contact/">Contact</a>
            </p>
            <span><script>document.write(new Date().getFullYear());</script></span>
            <span>&copy;</span>

            <a href="mailto:sol.rosca@gmail.com?subject=Hello&nbsp;RoscaS"> RoscaS</a>
            <br>
        </center>
    </div>
</footer>

<foot>
    <foot>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Derictory -->

  <script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
  <script src="http://yandex.st/highlightjs/6.2/highlight.min.js"></script>

<!-- Hit analytics -->

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<!-- Directory -->

<script src="/js/main.js"></script>

</foot>

</foot>

</html>
